(this["webpackJsonpreact-basic"]=this["webpackJsonpreact-basic"]||[]).push([[0],{36:function(e,t,s){},64:function(e,t,s){"use strict";s.r(t);var c=s(0),a=s(10),n=s.n(a),l=(s(36),s(7)),i=s(3),r=s(5),d=s(11);const o=Object(d.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{login:e=>{localStorage.setItem("isLoggedIn","yes"),e.isLoggedIn=!0},logout:e=>{localStorage.removeItem("isLoggedIn"),e.isLoggedIn=!1}}}),{login:j,logout:b}=o.actions;var h=o.reducer,O=s(1);var u=()=>{const e=Object(r.c)((e=>e.auth.isLoggedIn)),t=Object(r.b)();return Object(O.jsx)("nav",{className:"navbar navbar-dark bg-dark",children:Object(O.jsxs)("div",{className:"container",children:[Object(O.jsx)(l.b,{className:"navbar-brand",to:"/",children:"Home"}),Object(O.jsxs)("ul",{style:{flexDirection:"row"},className:"navbar-nav",children:[Object(O.jsx)("li",{className:"nav-item me-2",children:Object(O.jsx)("button",{className:"text-white btn btn-link text-decoration-none",onClick:()=>{t(e?b():j())},children:e?"Logout":"Login"})}),e?Object(O.jsx)("li",{className:"nav-item me-2",children:Object(O.jsx)(l.c,{className:e=>{let{isActive:t}=e;return"nav-link"+(t?" active":"")},"aria-current":"page",to:"/admin",children:"Admin"})}):null,Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)(l.c,{className:e=>{let{isActive:t}=e;return"nav-link"+(t?" active":"")},"aria-current":"page",to:"/blogs",children:"Blogs"})})]})]})})};var m=()=>Object(O.jsx)("h1",{children:"\ud504\ub85c\uc81d\ud2b8\ub85c \ubc30\uc6b0\ub294 \ub9ac\uc561\ud2b8"}),x=s(9),g=s.n(x),p=s(31);const v=Object(d.b)({name:"toast",initialState:{toasts:[]},reducers:{addToast:(e,t)=>{e.toasts.push(t.payload)},removeToast:(e,t)=>{e.toasts=e.toasts.filter((e=>e.id!==t.payload))}}}),{addToast:N,removeToast:f}=v.actions;var y=v.reducer;var k=()=>{const e=Object(r.b)(),t=t=>{e(f(t))};return{addToast:s=>{const c=Object(p.v4)(),a={...s,id:c};e(N(a)),setTimeout((()=>{t(c)}),5e3)},deleteToast:t}};var S=()=>Object(O.jsx)("div",{className:"d-flex justify-content-center",children:Object(O.jsx)("div",{className:"spinner-border",role:"status",children:Object(O.jsx)("span",{className:"visually-hidden",children:"Loading..."})})});const w=e=>{let{editing:t}=e;const s=Object(i.p)(),{id:a}=Object(i.r)(),[n,l]=Object(c.useState)(""),[r,d]=Object(c.useState)(""),[o,j]=Object(c.useState)(""),[b,h]=Object(c.useState)(""),[u,m]=Object(c.useState)(!1),[x,p]=Object(c.useState)(!1),[v,N]=Object(c.useState)(!1),[f,y]=Object(c.useState)(!1),[w,C]=Object(c.useState)(!0),[T,P]=Object(c.useState)(""),{addToast:I}=k();Object(c.useEffect)((()=>{t?g.a.get(`http://localhost:3001/posts/${a}`).then((e=>{l(e.data.title),d(e.data.title),j(e.data.body),h(e.data.body),m(e.data.publish),p(e.data.publish),C(!1)})).catch((e=>{P("something went wrong in db"),I({type:"danger",text:"something went wrong in db"}),C(!1)})):C(!1)}),[a,t]);return w?Object(O.jsx)(S,{}):T?Object(O.jsx)("div",{children:T}):Object(O.jsxs)("div",{children:[Object(O.jsxs)("h1",{children:[t?"Edit":"Create"," a blog post"]}),Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("label",{className:"form-label",children:"Title"}),Object(O.jsx)("input",{className:"form-control "+(v?"border-danger":""),value:n,onChange:e=>{l(e.target.value)}}),v&&Object(O.jsx)("div",{className:"text-danger",children:"Title is required."})]}),Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("label",{className:"form-label",children:"Body"}),Object(O.jsx)("textarea",{className:"form-control "+(f?"border-danger":""),value:o,onChange:e=>{j(e.target.value)},rows:"10"}),f&&Object(O.jsx)("div",{className:"text-danger",children:"Body is required."})]}),Object(O.jsxs)("div",{className:"form-check mb-3",children:[Object(O.jsx)("input",{className:"form-check-input",type:"checkbox",checked:u,onChange:e=>{m(e.target.checked)}}),Object(O.jsx)("label",{className:"form-check-label",children:"Publish"})]}),Object(O.jsx)("button",{className:"btn btn-primary",onClick:()=>{N(!1),y(!1),(()=>{let e=!0;return""===n&&(N(!0),e=!1),""===o&&(y(!0),e=!1),e})()&&(t?g.a.patch(`http://localhost:3001/posts/${a}`,{title:n,body:o,publish:u}).then((e=>{console.log(e),s(`/blogs/${a}`)})).catch((e=>{I({type:"danger",text:"We could not update blog"})})):g.a.post("http://localhost:3001/posts",{title:n,body:o,publish:u,createdAt:Date.now()}).then((()=>{I({type:"success",text:"Successfully created!"}),s("/admin")})).catch((e=>{I({type:"danger",text:"We could not create blog"})})))},disabled:t&&!(n!==r||o!==b||u!==x),children:t?"Edit":"Post"}),Object(O.jsx)("button",{className:"btn btn-danger ms-2",onClick:()=>{s(t?`/blogs/${a}`:"/blogs")},children:"Cancel"})]})};w.defaultProps={editing:!1};var C=w;var T=e=>{let{addToast:t}=e;return Object(O.jsx)("div",{children:Object(O.jsx)(C,{addToast:t})})};var P=()=>Object(O.jsx)("div",{children:Object(O.jsx)(C,{editing:!0})});const I=e=>{let{title:t,onClick:s,children:c}=e;return Object(O.jsx)("div",{className:"card mb-3 cursor-pointer",onClick:s,children:Object(O.jsxs)("div",{className:"card-body py-2 d-flex align-items-center",children:[Object(O.jsx)("div",{className:"flex-grow-1",children:t}),c&&Object(O.jsx)("div",{children:c})]})})};I.defaultProps={children:null,onClick:()=>{}};var L=I;const $=e=>{let{currentPage:t,numberOfPages:s,onClick:c,limit:a}=e;const n=Math.ceil(t/a),l=Math.ceil(s/a),i=a*(n-1)+1,r=n===l?s%a:a;return Object(O.jsx)("nav",{"aria-label":"Page navigation example",children:Object(O.jsxs)("ul",{className:"pagination justify-content-center",children:[1!==n&&Object(O.jsx)("li",{className:"page-item",children:Object(O.jsx)("div",{className:"page-link cursor-pointer",href:"#",onClick:()=>c(i-a),children:"Previous"})}),Array(r).fill(i).map(((e,t)=>e+t)).map((e=>Object(O.jsx)("li",{className:"page-item "+(t===e?"active":""),children:Object(O.jsx)("div",{className:"page-link cursor-pointer",onClick:()=>{c(e)},children:e})},e))),n!==l&&Object(O.jsx)("li",{className:"page-item",children:Object(O.jsx)("div",{className:"page-link cursor-pointer",href:"#",onClick:()=>c(i+a),children:"Next"})})]})})};$.defaultProps={currentPage:1,limit:5};var A=$;const E=e=>{let{isAdmin:t}=e;const s=Object(i.p)(),a=Object(i.n)(),n=new URLSearchParams(a.search).get("page"),[l,r]=Object(c.useState)([]),[d,o]=Object(c.useState)(!0),[j,b]=Object(c.useState)(1),[h,u]=Object(c.useState)(0),[m,x]=Object(c.useState)(0),[p,v]=Object(c.useState)(""),[N,f]=Object(c.useState)(""),{addToast:y}=k();Object(c.useEffect)((()=>{x(Math.ceil(h/5))}),[h]);const w=Object(c.useCallback)((function(){let e={_page:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,_limit:5,_sort:"id",_order:"desc",title_like:p};t||(e={...e,publish:!0}),g.a.get("http://localhost:3001/posts",{params:e}).then((e=>{u(e.headers["x-total-count"]),r(e.data),o(!1)})).catch((e=>{o(!1),f("Something went wrong in database"),y({text:"Something went wrong",type:"danger"})}))}),[t,p]);Object(c.useEffect)((()=>{b(parseInt(n)||1),w(parseInt(n)||1)}),[]);if(d)return Object(O.jsx)(S,{});return N?Object(O.jsx)("div",{children:N}):Object(O.jsxs)("div",{children:[Object(O.jsx)("input",{type:"text",placeholder:"Search..",className:"form-control",value:p,onChange:e=>v(e.target.value),onKeyUp:e=>{"Enter"===e.key&&(s(`${a.pathname}?page=1`),b(1),w(1))}}),Object(O.jsx)("hr",{}),0===l.length?Object(O.jsx)("div",{children:"No blog posts found"}):Object(O.jsxs)(O.Fragment,{children:[l.map((e=>Object(O.jsx)(L,{title:e.title,onClick:()=>s(`/blogs/${e.id}`),children:t?Object(O.jsx)("div",{children:Object(O.jsx)("button",{className:"btn btn-danger btn-sm",onClick:t=>((e,t)=>{e.stopPropagation(),g.a.delete(`http://localhost:3001/posts/${t}`).then((()=>{w(1),y({text:"Successfully deleted",type:"success"})})).catch((e=>{y({text:"The blog could not be deleted.",type:"danger"})}))})(t,e.id),children:"Delete"})}):null},e.id))),m>1&&Object(O.jsx)(A,{currentPage:j,numberOfPages:m,onClick:e=>{s(`${a.pathname}?page=${e}`),b(e),w(e)}})]})]})};E.defaultProps={isAdmin:!1};var B=E;var _=()=>Object(O.jsxs)("div",{children:[Object(O.jsx)("div",{className:"d-flex justify-content-between",children:Object(O.jsx)("h1",{children:"Blogs"})}),Object(O.jsx)(B,{})]});var D=()=>Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(O.jsx)("h1",{children:"Admin"}),Object(O.jsx)("div",{children:Object(O.jsx)(l.b,{to:"/blogs/create",className:"btn btn-success",children:"Create New"})})]}),Object(O.jsx)(B,{isAdmin:!0})]});var M=()=>{const{id:e}=Object(i.r)(),[t,s]=Object(c.useState)(null),[a,n]=Object(c.useState)(!0),d=Object(r.c)((e=>e.auth.isLoggedIn)),{addToast:o}=k(),[j,b]=Object(c.useState)("");Object(c.useEffect)((()=>{(e=>{g.a.get(`http://localhost:3001/posts/${e}`).then((e=>{s(e.data),n(!1)})).catch((e=>{b("something went wrong in db"),o({type:"danger",text:"something went wrong in db"}),n(!1)}))})(e)}),[e]);return a?Object(O.jsx)(S,{}):j?Object(O.jsx)("div",{children:j}):Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{className:"d-flex",children:[Object(O.jsx)("h1",{className:"flex-grow-1",children:t.title}),d&&Object(O.jsx)("div",{children:Object(O.jsx)(l.b,{className:"btn btn-primary",to:`/blogs/${e}/edit`,children:"Edit"})})]}),Object(O.jsxs)("small",{className:"text-muted",children:["Created At: ",(h=t.createdAt,new Date(h).toLocaleString())]}),Object(O.jsx)("hr",{}),Object(O.jsx)("p",{children:t.body})]});var h};var q=()=>Object(O.jsx)("div",{children:"404 Page Not Found"});var F=[{path:"/",element:Object(O.jsx)(m,{})},{path:"/blogs",element:Object(O.jsx)(_,{})},{path:"/admin",element:Object(O.jsx)(D,{}),auth:!0},{path:"/blogs/create",element:Object(O.jsx)(T,{}),auth:!0},{path:"/blogs/:id/edit",element:Object(O.jsx)(P,{}),auth:!0},{path:"/blogs/:id",element:Object(O.jsx)(M,{})},{path:"*",element:Object(O.jsx)(q,{})}];const J=e=>{let{toasts:t,deleteToast:s}=e;return Object(O.jsx)("div",{className:"position-fixed bottom-0 end-0 p-2",children:t.map((e=>Object(O.jsx)("div",{onClick:()=>{s(e.id)},className:`cursor-pointer alert alert-${e.type||"success"} m-0 py-2 mt-2`,children:e.text},e.id)))})};J.defaultProps={toasts:[]};var U=J;var W=e=>{let{element:t}=e;return Object(r.c)((e=>e.auth.isLoggedIn))?t:Object(O.jsx)(i.a,{to:"/"})};var H=function(){const e=Object(r.c)((e=>e.toast.toasts)),{deleteToast:t}=k(),[s,a]=Object(c.useState)(!0),n=Object(r.b)();return Object(c.useEffect)((()=>{localStorage.getItem("isLoggedIn")&&n(j()),a(!1)}),[]),s?Object(O.jsx)(S,{}):Object(O.jsxs)(l.a,{children:[Object(O.jsx)(u,{}),Object(O.jsx)(U,{toasts:e,deleteToast:t}),Object(O.jsx)("div",{className:"container mt-3",children:Object(O.jsx)(i.d,{children:F.map((e=>Object(O.jsx)(i.b,{path:e.path,element:e.auth?Object(O.jsx)(W,{element:e.element}):e.element},e.path)))})})]})};const K=Object(d.a)({reducer:{toast:y,auth:h}});n.a.render(Object(O.jsx)(r.a,{store:K,children:Object(O.jsx)(H,{})}),document.getElementById("root"))}},[[64,1,2]]]);
//# sourceMappingURL=main.3d29027e.chunk.js.map